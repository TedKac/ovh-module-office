<div data-ovh-alert="{{alerts.dashboard}}"></div>

<div class="loader text-center" data-ng-if="MicrosoftOfficeLicenseCtrl.loaders.tenant"></div>

<div data-ng-if="!MicrosoftOfficeLicenseCtrl.loaders.tenant">
    <div class="page-header">
        <form class="mb-4" name="form-license-group-name" novalidate
              data-ng-submit="MicrosoftOfficeLicenseCtrl.saveDisplayName(currentLicense, MicrosoftOfficeLicenseCtrl.license.tenant)">
            <label class="control-label m-0" for="license-group-name"
                   data-i18n-static="microsoft_office_license_group_name"></label>
            <div class="mb-3" data-ng-show="!MicrosoftOfficeLicenseCtrl.editMode">
                <div class="d-flex">
                    <h1 class="d-inline-block mb-0 word-break" data-ng-bind="MicrosoftOfficeLicenseCtrl.license.tenant.displayName"></h1>
                    <button class="btn btn-icon my-auto ml-2" type="button" aria-label="{{i18n.microsoft_office_license_edit}}"
                            data-ng-click="MicrosoftOfficeLicenseCtrl.editDisplayName(MicrosoftOfficeLicenseCtrl.license.tenant)"
                            data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant">
                        <span class="oui-icon oui-icon-pen_line oui-icon_small" aria-hidden="true"></span>
                    </button>
                </div>
                <span class="font-italic"
                      data-ng-bind="currentLicense"
                      data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant.displayName && currentLicense !== MicrosoftOfficeLicenseCtrl.license.tenant.displayName"></span>
            </div>

            <div class="form-group my-4"
                 data-ng-show="MicrosoftOfficeLicenseCtrl.editMode">
                <div class="input-group">
                    <input type="text" class="form-control input-lg" id="license-group-name"
                           data-ng-model="MicrosoftOfficeLicenseCtrl.newDisplayName.value">
                    <div class="input-group-btn">
                        <button class="btn btn-success btn-lg" type="submit"
                                data-ng-disabled="form-license-group-name.$invalid">
                            <span class="fa fa-check" aria-hidden="true"></span>
                            <span class="sr-only" data-i18n-static="microsoft_office_license_edit_save"></span>
                        </button>
                        <button class="btn btn-danger btn-lg" type="button"
                                data-ng-click="MicrosoftOfficeLicenseCtrl.resetDisplayName($event)">
                            <span class="fa fa-remove" aria-hidden="true"></span>
                            <span class="sr-only" data-i18n-static="common_cancel"></span>
                        </button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div data-ng-controller="MicrosoftOfficeLicenseTabsCtrl">
        <ovh-tabs tabs="tabs"
                  selected-tab="selectedTab"
                  change-tab="setSelectedTab"
                  product="microsoftOfficeLicense"
                  tr="tr"></ovh-tabs>
        <div class="tab-content">
            <div class="tab-pane active"
                 data-ng-include="'microsoft/office/license/' + toKebabCase(selectedTab) + '/' + selectedTab + '.html' || ''"></div>
        </div>
    </div>

    <div id="currentAction" class="modal fade currentAction" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div id="modal-container" class="modal-content" data-ng-include="MicrosoftOfficeLicenseCtrl.stepPath"></div>
            <div id="modal-help" class="help4wizards"></div>
        </div>
    </div>
</div>
