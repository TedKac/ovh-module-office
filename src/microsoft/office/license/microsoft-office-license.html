<div data-ovh-alert="{{alerts.dashboard}}"></div>

<div class="loader text-center" data-ng-if="MicrosoftOfficeLicenseCtrl.loaders.tenant"></div>

<div data-ng-if="!MicrosoftOfficeLicenseCtrl.loaders.tenant">
    <div class="page-header">
        <form class="mb-4" name="form-license-group-name" novalidate
              data-ng-submit="MicrosoftOfficeLicenseCtrl.saveDisplayName(currentLicense, MicrosoftOfficeLicenseCtrl.license.tenant)">
            <label class="control-label" for="license-group-name"
                   data-i18n-static="microsoft_office_license_group_name"></label>
            <h1 class="wordbreak m-0"
                data-ng-show="!MicrosoftOfficeLicenseCtrl.editMode">
                <span data-ng-bind="MicrosoftOfficeLicenseCtrl.license.tenant.displayName"></span>
                <button class="btn btn-icon" type="button" aria-label="{{i18n.microsoft_office_license_edit}}"
                        data-ng-click="MicrosoftOfficeLicenseCtrl.editDisplayName(MicrosoftOfficeLicenseCtrl.license.tenant)"
                        data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant">
                    <span class="fa fa-pencil fa-lg" aria-hidden="true"></span>
                </button>
                <small class="d-block"
                       data-ng-bind="currentLicense"
                       data-ng-if="MicrosoftOfficeLicenseCtrl.license.tenant.displayName && currentLicense !== MicrosoftOfficeLicenseCtrl.license.tenant.displayName"></small>
            </h1>
            <div class="input-group" data-ng-show="MicrosoftOfficeLicenseCtrl.editMode">
                <input type="text" class="form-control input-lg" id="license-group-name"
                       data-ng-keyup="MicrosoftOfficeLicenseCtrl.resetDisplayName($event)"
                       data-ng-model="MicrosoftOfficeLicenseCtrl.newDisplayName.value">
                <div class="input-group-btn">
                    <button class="btn btn-success btn-lg" type="submit" aria-label="{{i18n.microsoft_office_license_edit_save}}"
                            data-uib-tooltip="{{i18n.microsoft_office_license_edit_save}}">
                        <span class="fa fa-check" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </form>
    </div>

    <div data-ng-controller="MicrosoftOfficeLicenseTabsCtrl">
        <ovh-tabs tabs="tabs"
                  selected-tab="selectedTab"
                  change-tab="setSelectedTab"
                  product="microsoftOfficeLicense"
                  tr="tr"></ovh-tabs>
        <div class="tab-content">
            <div class="tab-pane active"
                 data-ng-include="'microsoft/office/license/' + toKebabCase(selectedTab) + '/' + selectedTab + '.html' || ''"></div>
        </div>
    </div>

    <div id="currentAction" class="modal fade currentAction" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div id="modal-container" class="modal-content" data-ng-include="MicrosoftOfficeLicenseCtrl.stepPath"></div>
            <div id="modal-help" class="help4wizards"></div>
        </div>
    </div>
</div>
